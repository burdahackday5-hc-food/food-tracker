<div class="food-form" [ngSwitch]="state">
  <h1>Track your meal</h1>

  <form *ngSwitchCase="FormState.EDITING" (ngSubmit)="onSubmit()">
    <mat-form-field>
      <input name="description" matInput placeholder="Description" [(ngModel)]="model.description">
    </mat-form-field>
    <mat-checkbox name="answer0" [checked]="model.answers[0] == 1" (change)="model.answers[0] = $event.checked ? 1:0">
      No carbohydrates
    </mat-checkbox>
    <mat-checkbox name="answer1" [checked]="model.answers[1] == 1" (change)="model.answers[1] = $event.checked ? 1:0">
      Small portion
    </mat-checkbox>
    <mat-checkbox name="answer2" [checked]="model.answers[2] == 1" (change)="model.answers[2] = $event.checked ? 1:0">
      Low sodium
    </mat-checkbox>
    <div>
      Take a picture
      <div class="action-button" [hidden]="model.picture">
        <button mat-fab color="accent" (click)="fileInput.click()" type="button">
          <i class="material-icons">photo_camera</i>
          <input #fileInput type="file" (change)="pictureChanged($event)" hidden accept="image/*"
                 capture="environment"/>
        </button>
      </div>
      <div *ngIf="model.picture" class="pic-preview">
        <img [src]="model.picture">
        <mat-checkbox>
          Post to Instagram
        </mat-checkbox>
      </div>
    </div>
    <div *ngIf="!model.description">
      <div>Scan Barcode</div>
      <div class="action-button">
        <button mat-fab color="accent" type="button" (click)="barcodeScanner = true" *ngIf="!barcodeScanner">
          <i class="material-icons">settings_remote</i>
        </button>
      </div>
      <app-product-barcode-scanner *ngIf="barcodeScanner" (found)="barcodeProductFound($event)"></app-product-barcode-scanner>
      <div *ngIf="barcodeScanner">
        <button mat-raised-button color="accent" type="button" (click)="barcodeScanner = false">Stop</button>
      </div>
    </div>

    <button mat-raised-button color="primary" type="submit">Submit</button>
  </form>

  <div *ngSwitchCase="FormState.SUBMITTING">
    <mat-progress-bar mode="indeterminate"></mat-progress-bar>
  </div>

  <div *ngSwitchCase="FormState.SUBMITTED">
    <div><i class="material-icons">check</i> Your meal was submitted!</div>
    <div style="margin-top: 15px;">
      <button mat-raised-button color="accent" (click)="reset()">Track another meal</button>
    </div>
  </div>
</div>
